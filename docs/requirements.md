# SnatchTradingChatApp 要件定義書

## 1. 概要
本ドキュメントは、投資コミュニティ向けチャットアプリケーション「SnatchTradingChatApp」の要件を定義するものです。

## 2. 機能要件

### 2.1 認証・アカウント管理

#### 2.1.1 ユーザー認証とアカウント管理
- **機能**: X（Twitter）認証によるログイン機能
- **詳細**:
  - OAuth 2.0を使用したX（Twitter）連携
  - ユーザープロフィール情報の取得と管理
- **優先度**: 高

#### 2.1.2 ユーザー権限と役割
- **機能**: 管理者権限によるユーザー権限設定
- **詳細**:
  - 管理者、一般ユーザー、ゲストユーザーの役割分離
  - 権限に基づくアクセス制御
- **優先度**: 高

### 2.2 コミュニケーション機能

#### 2.2.1 チャット機能
- **機能**: 書式設定、メディア送受信、リアクション、リプライ機能
- **詳細**:
  - テキストフォーマット（太字、斜体、コードブロック等）
  - 画像、動画、ファイルの送受信
  - 絵文字リアクション機能
  - メッセージへの返信機能
- **優先度**: 高

#### 2.2.2 メッセージインタラクション
- **機能**: メッセージへのリアクション、返信（スレッド形式）
- **詳細**:
  - スレッド形式での会話管理
  - リアクション通知機能
- **優先度**: 高

#### 2.2.3 ダイレクトメッセージ
- **機能**: プライベートメッセージ送信機能
- **詳細**:
  - 1対1のプライベートチャット
  - 既読機能
- **優先度**: 高

### 2.3 チャンネル・ルーム管理

#### 2.3.1 チャットルームとチャンネル
- **機能**: 匿名質問ルーム、チャンネル追加・管理機能
- **詳細**:
  - チャンネルの作成、編集、削除
  - 匿名質問投稿機能
  - チャンネル参加者管理
- **優先度**: 高

#### 2.3.2 チャンネルの種類
- **機能**: 公開チャンネル、管理者専用チャンネル
- **詳細**:
  - 管理者が一般ユーザーのチャンネルへの権限を操作することができる
    - 一般ユーザーの閲覧権限あり、投稿権限なし
    - 一般ユーザーの閲覧権限、投稿権限なし
  - パブリックチャンネル（全ユーザー参加可能）
  - 管理者専用チャンネル
- **優先度**: 高

### 2.4 検索・ナビゲーション

#### 2.4.1 検索機能
- **機能**: メッセージ、ユーザー、チャンネルの検索
- **詳細**:
  - 全文検索機能
  - フィルタリング機能（日付、ユーザー、チャンネル等）
- **優先度**: 中

#### 2.4.2 ナビゲーションとインターフェース
- **機能**: アプリ内セクションの簡単ナビゲーション
- **詳細**:
  - 直感的なUI/UX設計
  - サイドバーナビゲーション
  - ショートカットキー対応
- **優先度**: 高

### 2.5 通知システム

#### 2.5.1 通知
- **機能**: チャット、チャネル、記事投稿のPush通知、メンション・リアクション時通知
- **詳細**:
  - プッシュ通知設定のカスタマイズ
  - 通知制限設定（時間帯、頻度等）
  - デスクトップ/モバイル通知対応
- **優先度**: 高

### 2.6 決済・サブスクリプション

#### 2.6.1 決済統合
- **機能**: コミュニティサブスクライブのためのStripe決済機能
- **詳細**:
  - 月額/年額サブスクリプション
  - 自動更新機能
  - 決済履歴管理
- **優先度**: 高

### 2.7 自動化・ボット機能

#### 2.7.1 ボット統合
- **機能**: cronによる投資情報取得、定型文字投稿、スクリプト実行
- **詳細**:
  - 定期的な市場情報の自動取得・投稿
  - カスタムボットの作成・管理
  - Webhook連携
- **優先度**: 高

### 2.8 コンテンツ管理

#### 2.8.1 記事作成機能
- **機能**: 管理者による投資記事作成・閲覧機能
- **詳細**:
  - リッチテキストエディタ
  - 画像・グラフの埋め込み
  - 記事の公開/非公開設定
- **優先度**: 高

### 2.9 管理機能

#### 2.9.1 CSV出力による管理者機能
- **機能**: 入退室者ログのCSV出力
- **詳細**:
  - ユーザーアクティビティログ
  - 期間指定でのデータエクスポート
  - 管理レポート生成
  - 管理機能を実装せずとも、どのユーザーがいつ退会したか、入会したかの記録はDBに保存する必要がある
- **優先度**: 低

### 2.10 設定画面機能

#### 2.10.1 一般ユーザー向け設定
- **機能**: アカウント、通知、セキュリティ、サブスクリプション設定
- **詳細**:
  - プロフィール編集、アバター変更、X（Twitter）連携管理
  - 詳細な通知設定（チャンネル別、ユーザー別、キーワード通知）
  - セキュリティ設定（パスワード変更、2段階認証、セッション管理）
  - サブスクリプション管理（プラン確認、変更、支払い方法、請求履歴）
  - アプリ情報、利用規約、プライバシーポリシー、ログアウト
- **優先度**: 高

#### 2.10.2 管理者向け設定
- **機能**: ユーザー管理、システム設定、コミュニティ設定
- **詳細**:
  - ユーザー一覧、権限変更、ブロック管理、入退会ログ（CSVエクスポート付き）
  - チャンネル管理、ボット設定、記事管理、システムログ
  - コミュニティ情報編集、参加条件設定、お知らせ管理
  - ユーザーのブロック、ブロック解除機能
    - 投稿権限剥奪
    - ユーザーの強制退会
- **優先度**: 高

### 2.11 将来的な拡張機能

#### 2.11.1 株式投資要素（仮）
- **機能**: 今後検討予定
- **詳細**:
  - ポートフォリオ管理
  - リアルタイム株価表示
  - 投資パフォーマンス追跡
- **優先度**: 仮設定

## 3. 非機能要件

### 3.1 パフォーマンス
- レスポンスタイム: 平均2秒以内
- 同時接続ユーザー数: 1000人以上対応
- Websocket: リアルタイム同期通信

### 3.2 セキュリティ
- SSL/TLS暗号化通信
- データの暗号化保存
- 定期的なセキュリティ監査

### 3.3 可用性
- 稼働率: 99.9%以上
- 定期メンテナンス時間の最小化

### 3.4 スケーラビリティ
- 水平スケーリング対応
- クラウドインフラストラクチャの活用

## 4. 開発優先順位

### 高優先度
1. ユーザー認証とアカウント管理（2.1.1）
2. ユーザー権限と役割（2.1.2）
3. チャット機能（2.2.1）
4. メッセージインタラクション（2.2.2）
5. ダイレクトメッセージ（2.2.3）
6. チャットルームとチャンネル（2.3.1）
7. チャンネルの種類（2.3.2）
8. ナビゲーションとインターフェース（2.4.2）
9. 通知（2.5.1）
10. 決済統合（2.6.1）
11. ボット統合（2.7.1）
12. 記事作成機能（2.8.1）
13. 一般ユーザー向け設定（2.10.1）
14. 管理者向け設定（2.10.2）

### 中優先度
1. 検索機能（2.4.1）

### 低優先度
1. CSV出力による管理者機能（2.9.1）

### 将来検討
1. 株式投資要素（2.11.1）
